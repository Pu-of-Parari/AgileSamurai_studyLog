# 第三部：アジャイルな計画作り

## 第六章：ユーザーストーリーを集める

ユーザーストーリーを使った要求の集め方を知ることで、

- どうやって計画に最新の状況を反映し続けるのか
- どうやって計画には一番新鮮で信頼のおける情報だけを含めるようにするのか
- どうすれば時期尚早な事前分析を避けられるのか

ができるようになる。

### 文書化の難しさ

実際のソフトウェアプロジェクトでは、何を文書に書くべきかを話し合うことに多くの時間を費やしてしまっている。

ソフトウェアへの要求を表現する手段として文書に頼りすぎることの弊害は時間だけじゃない。

- 変化に対処できない
- 顧客の欲しいものに合わせるのではなく、仕様に合わせて作ることになる
- 下手な推測や誤った前提を招き寄せる
- 多くの時間を無駄にする

要求を文書として集めようとすることの問題点は、用意する文書量の多寡ではない。コミュニケーションに問題がある。文書と会話できるわけじゃないし、他の誰かが書いた文書はとても誤解を招きやすい。

**アジャイル開発の原則：**

> 情報を伝える最も効率的で効果的な方法はface to faceで話をすることです。

### そこでユーザーストーリー

ユーザーストーリーは顧客がソフトウェアで実現したいと思っているフィーチャを簡潔に記述したもの。記述するインデックスカードには完結にしか書かないので、詳細は顧客のところへ出向いて直に会話することを促進するという仕掛けになっている。

要求を収集するときの一番の目的は、フィーチャの本質をとらえるキーワードを書き留めておくこと。ありとあらゆる詳細を聞き出すことではない。ユーザーストーリーは「会話の約束」だと考える。しかるべき時が来たらその項目について詳細を検討するが、それは本当に必要だという確信を持てるようになってからの話。

### よくかけているユーザーストーリーとは

よくかけているユーザーストーリーの特徴

- 顧客にとって何かしらの価値が書かれていること
  - 「価値がある」：君のお客さんが対価を払ってもいいと思えること
  - ユーザーストーリーはビジネスの観点から評価できなきゃいけない。お客さんに理解できるシンプルな言葉遣いで書く。
  - 「データベースにコネクションプールを導入する」-> 「現状の10秒かかるページ読み込み速度を2秒まで縮める」
- エンドツーエンドになっていること
  - ケーキを切るようにスライスする
  - アーキテクチャのすべてのレイヤを貫いて、お客さんにとって価値のある成果を届けるようにする
- ストーリーが独立している
  - プロジェクトには変化がつきもの
  - 必ずしもストーリーを互いに独立させられるわけじゃないが、できるだけエンドツーエンドの切り口になったフィーチャ単位で切り分けることを意識する
  - 独立していれば必要に応じてスコープを柔軟に調整できるようになる
- 交渉の余地がある
  - 予算の範囲内に収まるようにある程度の融通が利くようにできるから
  - ストーリーによってはポルシェ級のものが必要になることもあれば、質素なフォードで間に合うものもある
- テストできる
  - テストできる＝どうなっていればちゃんと動いているのかがわかる
  - 開発チームにとっては作業範囲と仕事の官僚基準が明確になる
- 小さい、見積もれる
  - ストーリーを1-5日で完了できるサイズまで小さくしておけばイテレーションの範囲に収まりそうかどうかは確実にわかる

ユーザーストーリーと要件定義書・仕様書の特徴まとめ

| ユーザーストーリー                                           | 要件定義書と仕様書                                           |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ・無駄がなく正確。必要な分を必要な時に<br />・対面でのコミュニケーションを促す<br />・計画がシンプル<br />・低コスト、素早く手軽<br />・最新の情報が反映される<br />・チームが学習することを踏まえている<br />・フィードバックを即時反映できる<br />・見積もり精度の高低に依らない<br />・チームの協調作業や新しい取り組みを歓迎する | ・重厚、不正確で最新じゃない<br />・憶測や誤った前提を招き寄せる<br />・計画が複雑<br />・コストがかさむ、遅い、手間がかかる<br />・情報が古くなったまま放置される<br />・チームが学習するといううことを考慮しない<br />・フィードバックを即時反映できない<br />・さも見積もり精度が高いかのように取り繕う<br />・オープンな協調作業や新しい取り組みを歓迎しない |

**ユーザーストーリーのテンプレート**

```
<ユーザーの種類>として、
<達成したいゴール>をしたい。
何故なら<理由>だからだ。
```

誰のためのストーリーで、何をしたいのか、なぜそうしたいのか

テンプレートを使うメリットとして、だれが、何を、なぜを明らかにできるし、ビジネスの視点に集中できるという点がある。デメリットとして、記述が冗長なので少しわかりづらいという点がある。テンプレートに従うもよし、短く簡潔にまとめるもよし。合わせ技もよし。



### ストーリー収集ワークショップを開こう

開発チーム、顧客が一緒になって開発対象のソフトウェアのユーザーストーリーを書いてみる。

ステップ

1. 大きく手見通しの良い部屋を用意する
   - 書いた図を張り出せる壁や、カードを並べておける大きなテーブルもあるとよい
2. 図をたくさん書く
   - ペルソナ(システムの想定ユーザーを表現したもの)
   - フローチャート、プロセスフロー
   - シナリオ
   - システム概要図
   - コンセプトデザイン
   - 絵コンテ　などなど
3. ユーザーストーリーをたくさん書く
   - 小さくて具体的なエンドツーエンドの機能を心がける(1-5日で実装できるサイズを目安に)
   - より大きなサイズのストーリーはエピックとして扱う
   - エピックはたぶんやらないといけないが本当に必要なのかはまだ確信が持てないものをくくりだしておくのにも便利
   - 1日かけて開催した場合で、ざっくりとしたストーリーを10-40挙げられれば十分。
4. その他もろもろをブレインストーミング
   - データ移行や負荷テスト、書類仕事、本番環境運用手順書やトレーニング教材の準備、検収期間など
   - プロジェクトのために必要なもろもろ全てをカードに書き留めておく
   - 他のストーリーと同じように優先順位をつけておく
5. リストを磨き上げる
   - 最初のマスターストーリーができたら、少し時間を取って眺めてみよう
   - もれなくダブりもない？
   - グループ分けできそうなストーリーはない？
   - お客さんにとって価値のある、シンプルでわかりやすいToDOリストになっている？

## 第七章：見積もり：当てずっぽうの奥義

### 概算見積もりの問題

プロジェクトの見積もりを取り巻く期待のマネジメントには課題がある。見積もりを未来の正確な予測だと思い込んでしまうことにある。

**概算見積もりなんて当てずっぽう**

事前見積もりを信じ切ってそのままプロジェクトを進めてしまうと、後になってその見積もりがプロジェクトを苦しめる、果たせない約束になってしまう。前もって見積もる時に、私たちが欲しい答えはただ一つ、**このプロジェクトをやり遂げられそうかどうか？**だけ。

そのために、次の3つの条件を満たすような見積もり手法が必要となる。

- 今後の計画を立てられる
- 見積もりは当てずっぽうだという前提を踏まえている
- ソフトウェア開発の複雑さを認めている

### ピンチをチャンスにする

何かを作る時にはそれがどれぐらいかかったかを計測して、それをもとに計画を立てる。計画を立てる上で踏まえるべきことは具体的に以下の２つ。

- ストーリーそれぞれを互いに相対的なサイズで見積もる
  - 過去に何度もやったことのある作業はX時間かかる。ならば、今回は...
  - 人間は相対的に見積もることは得意。
  - 注意：相対サイズ見積もりでの１日は実際のカレンダー上の１営業日とは必ずしも一緒じゃない問うことに留意しておく
- ポイントを基にして進捗を追跡する
  - 日数や時間で換算するのではなく「ポイント」で見積もってみる
    - １日の1.33倍＝1.33日　<- こんなの感覚的じゃない！
  - 見積もり結果の数値の単位には意味を持たせず、ただポイントとして表現することを推奨
  - 見積もりの数値と営業日の日数とを対応させないようにすることが狙い
  - 単位はなんでもいい。相対的な大きさの違いを表すことが重要。
  - ポイントで見積もることのメリット
    - 見積もりとは当てずっぽうであることを肝に銘じることができる
    - 見積もりとは純粋に大きさをはかるものだと考えられる
    - 手早く、気軽に、シンプルに見積もれる

### 見積もり技法

**三角測量**

代表的なストーリーをいくつか基準として選出して、残りのストーリーを基準になるストーリーとの相対サイズで見積もるやり方。

次のような視点からストーリーを眺め、基準となる代表的なストーリーを選定する。

- 論理的なグループ分けができそうなものはあるか？
- エンドツーエンドになっているストーリーはあるか？
- プロジェクトを象徴するような代表的なストーリーはどれか？

見積もりを進めていくうちに再見積もりすることになってもよい。明らかに見積もりが違うことがわかった場合は、見積もりの枠組みを見直して、もっと現実的な数字を割り当てなおすことになるのは当たり前。

これまでに経験がなくてサイズの検討がつかないストーリーに出くわした場合、「スパイク」を実践してみよう。スパイクとはタイムボックス化された実験のこと。ストーリーを見積もれるようになる程度に様々な調査を実施して、見積もったら止める(スパイクはあくまでも調査なので、ストーリーそのものは実装しない)。

**プランニングポーカー**

開発チームのメンバーは一つ一つのストーリーをまず自分自身で見積もる。見積もりの数値はカード(1, 3, 5)で見積もる。各人が見積もったらその数値をメンバー同士で見せ合って、チームとして統一した見積もりを出す。

いきなり初回でメンバー全員の意見が合致すればそれで決まり。食い違いがあればその違いについて話し合って再び各人が見積もる。チームで見積もり結果に合意ができるまで話し合いと再見積もりを繰り返す。

注意として、プランニングポーカーは投票システムではないということに留意しなければならない。3人の新米エンジニアの見積もりが1人の熟練エンジニアに「勝つ」仕組みではない。プランニングポーカーの狙いは個々人が三津からの見積もりについての意見を伝えあうことで、従来よりも適切な見積もりができるようになることにある。







